use strict;
use warnings;

use Test::More tests => 2;
use CracTools::BenchCT::Checker;
use Inline::Files 0.68;
use File::Temp;

my $checker_chim_file = new File::Temp( SUFFIX => '.tsv', UNLINK => 1);
while(<CHECKCHIM>) {print $checker_chim_file $_;}
close $checker_chim_file;  

my $checker = CracTools::BenchCT::Checker->new(chimera_tsv_file=>$checker_chim_file,verbose => 1 );

is($checker->isTrueChimera("19",1453610,1,"3",141262611,1),1);
is($checker->isTrueChimera("3",141262611,-1,"19",1453610,-1),1);

__CHECKCHIM__
19	1453611	1	3	141262613	1	35567956:35567958:35567960:35567962:35568711:35568713:35568715:35568717:35568719:35568721:35568723:35568725:35568727:35568729:35568731:35568733:35568735:35568737:35568739:35568874:35568876:35568878:35568880:35568882:35568884:35568886:35568888:35568890:35568892:35568894:35568896:35568898:35568900:35568902:35568904:35568906:35568908:35568910	38
__CRACCHIM__
19	1453610	+	3	141262611	+	0.994135	chr19:1446275-1486720W:ENST00000535453:22:3805:2089:2438/1,chr19:1446275-1486720W:ENST00000535453:24:3805:2089:2438/1,chr19:1446275-1486720W:ENST00000535453:480:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:481:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:482:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:483:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:484:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:485:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:486:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:487:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:488:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:489:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:490:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:491:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:492:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:493:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:494:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:495:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:497:3805:2090:2422/1,chr19:1446275-1486720W:ENST00000535453:498:3805:2090:2422/1	20
